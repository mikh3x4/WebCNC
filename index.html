<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="grid.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Web Pen Plotter</title>
    <!-- <link rel="stylesheet" href="pyscript/pyscript.css" /> -->
    <script defer src="pyscript/pyscript.js"></script>
    <script defer src="serial_sender.js"></script>

</head>

<body>
    <py-config>
        packages = ["vpype==1.13.0", "vpype-gcode", "vpype-dxf", "vpype-vectrace"]
        [splashscreen]
            enabled = false
    </py-config>
    <py-script src="penslicer.py"> </py-script>

<div class="container">
  <div class="Send-Command" style="display: flex; align-items: center;">

    <input type="text" id="lineToSend" style="flex: 1; ">
    <button onclick="sendSerialLine()" style="width: 50px; ">Send</button>
  </div>
  <div class="Blank"></div>
  <div class="Gcode-History">
    <div class="Banner"></div>

    <div id="output"> </div>
  </div>
  <div class="Slicing-Area">
    <div class="Banner2"></div>

    <div id="output-image"> </div>
  </div>
  <div class="Slicing-commands">
    <input type="file" id="file-upload" accept=".svg,.dxf,.png,.gcode" />

    <button id="process-button" py-click="loop.create_task(wrap(process_file()))">Process File</button>
    <button id="download-gcode-button" py-click="downloadFile()">Download Gcode</button>
  </div>
  <div class="Command-Buttons">

<br>
<button onclick="connectSerial()">Connect</button><br>

<button onclick="sendData('M17')">Motor On</button><br>
<button onclick="sendData('M18')">Motors Off</button><br>

<button onclick="sendData('G21G91Y5F1000')">Move Y+</button><br>
<button onclick="sendData('G21G91Y-5F1000')">Move Y-</button><br>
<button onclick="sendData('G21G91X5F1000')">Move X+</button><br>
<button onclick="sendData('G21G91X-5F1000')">Move X-</button><br>
<button onclick="sendData('M10 P0 S30')">Pen Up</button><br>
<button onclick="sendData('M10 P0 S100')">Pen Down</button><br>
<button onclick="estop_var = true;sendData('!');">ESTOP</button><br>
<button onclick="estop_var = false;sendData('~');">Resume</button><br>

<button onclick="rungcode()">Upload and Display</button>

<button onclick="serialResultsDiv.innerHTML = '';">Clear</button>
<br>
<label for="echoOn">
    <input type="checkbox" id="echoOn" onclick="localStorage.echoOn = this.checked;" checked>echo
</label>

  </div>
</div>

    <py-repl id="my-repl" auto-generate="true"> </py-repl>

</body>

</html>
